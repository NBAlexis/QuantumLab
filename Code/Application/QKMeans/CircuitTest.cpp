//=============================================================================
// FILENAME : CircuitTest.cpp
// 
// DESCRIPTION:
// 
//
// REVISION: [dd/mm/yy]
//  [16/03/2023 nbale]
//=============================================================================

#include "QKMeans.h"

static Real testVi[1056] = {
6.712470725820615658e-02f,-1.671320784889968880e-01f,1.446966140506703302e-01f,-2.603956357433916957e-01f,3.058524839849225407e-01f,-9.453388903848174152e-02f,-2.381628350006525785e-01f,-9.835715655650589806e-02f,1.375621140733927078e-02f,-2.013689612391147410e-01f,-2.271052389786270831e-01f,-1.270188614220339463e-01f,-2.438766759810776785e-01f,2.980908989533193054e-01f,-8.931874373746981344e-02f,8.290341521285687909e-02f,-5.713793705343014895e-02f,-5.754740802160218660e-02f,-6.624480246120216520e-02f,1.507560046283653032e-01f,-5.238080103560301126e-02f,1.767399018173313463e-01f,-1.137749962364306838e-01f,1.511427927170023999e-01f,1.995680647340984382e-01f,1.295796671250140364e-01f,-1.009994401965027128e-01f,2.344122020126397088e-01f,2.939243077584202113e-01f,-3.048720133234812391e-01f,9.383655966366810652e-04f,-1.836751293991971956e-01f,
-1.277572926964651023e-01f,-1.732017163865056386e-01f,-2.631784180628530811e-01f,6.788534685939855151e-02f,-1.963551080742648447e-01f,2.879249964581823487e-02f,2.472064747921517425e-01f,1.417902082079115222e-01f,1.554303157228144050e-01f,-3.438339894594476948e-02f,2.579030039078603620e-01f,-3.743611083508737586e-02f,-4.287917022979492038e-02f,2.699921221281130213e-01f,2.948848119467220585e-01f,-2.855829008098089705e-01f,-1.254205748328665049e-01f,2.389072705007118380e-02f,-8.650052974691239960e-02f,-2.671457723520766492e-01f,-1.783658185990731337e-01f,-8.065182428648534629e-02f,2.996142772231753515e-01f,7.167646771103824976e-02f,2.210955308337383685e-01f,-1.463655697720196991e-01f,-2.456609788852721632e-01f,1.832846051448744629e-01f,7.958743274110914590e-02f,1.399722514771698234e-01f,1.399419882368733124e-02f,6.289952300376130956e-02f,
-1.092190359704854619e-01f,1.219902709653878509e-01f,1.512356370270319939e-01f,2.654499810032553420e-01f,-1.180655001536219523e-01f,-2.796378254992923917e-01f,2.833523748012574117e-01f,1.293758810506407120e-01f,1.338732261158826764e-01f,4.701941668611956532e-02f,-2.864124258406924861e-02f,2.820192748615716893e-01f,2.353418834430074102e-01f,2.662240407579479773e-01f,1.222687156080685400e-01f,5.106983616845536117e-02f,1.699435984628022978e-01f,3.011116190326259545e-01f,2.648269841109587297e-01f,-1.294483760647865134e-01f,-1.826391334820739731e-01f,-1.333256922965297443e-02f,-2.791474444905176489e-01f,-1.411034502210849750e-01f,1.744512015302935315e-01f,-1.978621072236822279e-02f,-4.433528165456109005e-02f,1.820948858791922587e-01f,-1.906089036875574516e-01f,-3.767713181388814697e-02f,6.972825375545413373e-02f,-3.683482661581673201e-03f,
2.403588208919147373e-01f,2.360846594975611612e-01f,1.236727511018617665e-01f,1.374832099647503025e-01f,-4.561692479835659231e-02f,-1.856758102857112847e-01f,-1.919400137865397704e-01f,-2.266542661487244426e-01f,8.740073423090330418e-02f,9.306519836147131297e-02f,2.052487375805092107e-01f,2.490108000876783620e-02f,-2.617074266150769546e-01f,-2.504376871319844988e-01f,-2.163008982900872512e-01f,1.044688643982959880e-01f,1.142748716385565133e-02f,-2.484847421735413842e-01f,-1.738796732637778730e-01f,6.008764374254341178e-02f,1.158057920244603550e-01f,-9.278473234697807819e-04f,2.275538208303959087e-01f,2.735371517665445285e-01f,-1.995646928406934473e-01f,-9.289475337697888913e-02f,-1.280974866477101459e-01f,-1.711791755890380851e-01f,2.935910983339627411e-01f,9.095441847069338226e-02f,-2.279776610210517140e-01f,5.678628398932208943e-02f,
-2.002445083122597058e-01f,-1.211174060564271238e-01f,-1.138973196440341423e-01f,-8.506866851648749173e-02f,-1.230608772618245195e-01f,1.816301760296253065e-01f,-2.690810440043234775e-01f,-3.958943988426557453e-02f,2.834060640561267969e-02f,-2.983580856314810847e-01f,-2.060689280198053086e-01f,1.300995001006731433e-01f,-1.949105784069838643e-01f,2.324363313444774426e-01f,-2.507413362047143379e-01f,-1.599750966103148375e-01f,-6.469891767169999586e-02f,-8.951409295899162566e-02f,-4.700513456218251285e-02f,-2.369567421073997260e-01f,1.713993122679336178e-01f,3.141138799759854994e-01f,-1.188721179081729806e-01f,-3.064834376201329147e-01f,5.183429740804671587e-02f,2.696266221455787676e-02f,-2.742488389966689089e-01f,1.348738544811082796e-01f,2.362521343349109626e-01f,-8.288141074096394556e-02f,4.357555376747772324e-02f,-7.184653563085792449e-02f,
-9.834980983121915932e-02f,-7.792038081517813075e-02f,-2.283543866287261748e-01f,1.570278586045790736e-01f,-2.150111838896341665e-01f,2.208277302161670841e-01f,2.017683506267903271e-01f,2.275910693076641234e-01f,1.770252811227338019e-02f,-1.407626879596801106e-01f,-1.636546307385831345e-01f,-5.371195109734822060e-02f,-1.263545038131773934e-01f,-1.192423166692504477e-01f,-1.083853346126041062e-01f,1.462286237274872669e-01f,2.817395514910513432e-01f,2.753519739914026335e-02f,-2.327462715648377645e-01f,2.658738687404142986e-01f,-1.150900794890431927e-01f,1.177648291602283320e-01f,-1.231725336092203693e-01f,-8.712554132208817637e-02f,3.114699103014780257e-01f,2.850771511732808627e-01f,1.165548738352543620e-02f,-2.193470178546982896e-01f,-1.054235326134083175e-02f,-3.049217404029796463e-01f,-1.764369880556483083e-01f,-3.490129953470117591e-02f,
-6.183249928866497991e-02f,2.685010309895757286e-01f,-1.939994537184913936e-01f,-3.221826855758119779e-01f,1.881273675930861533e-01f,-1.214667279144414774e-01f,-2.889176256838963102e-03f,-1.493171633924548769e-01f,-1.308118457682440339e-01f,2.634458465746490341e-01f,4.855342048259558146e-02f,-1.204210276091355059e-01f,1.474439599018289582e-01f,5.889143526787424948e-02f,-2.839487436445027949e-02f,-4.654085860090582949e-02f,-1.104588071730519261e-01f,2.263656555056787201e-01f,1.639617843844343170e-01f,4.857218009950813736e-02f,2.691301491153460512e-01f,5.544079553601244381e-02f,4.404699767285884249e-02f,-2.343889848097757689e-01f,5.799578219966926296e-02f,9.110219612097514297e-02f,1.918759615457701351e-01f,-2.951731393346986865e-01f,-1.745976512890447252e-01f,-6.773221807476623169e-02f,2.806277605404527420e-01f,-3.227121354841592793e-01f,
2.221294443797691143e-01f,1.044691699812759778e-01f,-2.311195910403612552e-01f,-9.237677582535190612e-02f,-1.120796338093361100e-01f,-2.231435808953979028e-01f,-2.512420995526212231e-01f,1.140140313718078155e-02f,-1.643125868670887446e-02f,1.901793785760124700e-01f,-8.295295085857178063e-02f,-2.116379525908050063e-01f,-1.718118620483169157e-01f,-2.252479462745864414e-01f,1.990055317048568945e-02f,4.959847642318424878e-03f,7.884697158533358896e-02f,1.058101600557935645e-01f,-6.990256282828291590e-02f,-2.817866381631377592e-01f,-1.680239975805824237e-01f,1.999598922275773738e-01f,-2.712752142038543646e-01f,2.229564459757625849e-01f,-2.842418032138224193e-01f,-2.634840788592608396e-01f,1.420334161718269372e-01f,1.096901645129746139e-01f,2.926760000779080606e-01f,1.442688780605406729e-01f,-3.487085007065399839e-02f,8.422184275926985347e-03f,
-2.523004673011570165e-01f,2.116796042475868611e-01f,-1.808138004923109665e-01f,-1.966549462752508193e-01f,2.343932237701624732e-01f,2.287806690438988211e-01f,-2.553405533880376832e-01f,1.717159488296312875e-01f,2.771360610185493178e-01f,-5.057391206994350102e-02f,-4.588054641340995332e-02f,-1.778485103498417541e-01f,2.671986238494317156e-01f,-3.460537163743356709e-02f,2.550154353499012316e-01f,1.593714526009037125e-01f,-7.901948519093732193e-02f,-1.720118273695745714e-01f,2.061838301577083865e-01f,2.454812503211776797e-01f,3.314477789317431949e-02f,-1.011974502376087326e-01f,-5.325508908053613183e-02f,-1.410923896939302868e-01f,2.585344225701350918e-01f,1.524930307846201205e-01f,2.550103683086625897e-02f,-2.059044621825748267e-01f,-8.382709116898309776e-02f,1.680529161912439062e-01f,-1.436839593469029430e-03f,3.133517720756416602e-02f,
1.432406070340018489e-01f,-1.711707782740906347e-01f,-1.753903806624536599e-01f,2.174879037839363427e-01f,-1.592810931113047279e-01f,1.716125852670163099e-01f,2.548389791689968931e-01f,-2.791414751316512177e-01f,-1.059158712625840881e-01f,-3.976551359572286920e-02f,4.683886671338160362e-02f,1.702893456744583867e-01f,7.107391265806035918e-02f,2.194529834430417395e-02f,2.619085797638385227e-01f,1.502744973056932554e-01f,2.611159668686167598e-02f,-1.581608787197743282e-01f,3.850866222034472069e-02f,-5.398515534902816743e-02f,-7.214115515905208942e-02f,2.066586110926342812e-01f,-2.350205768868475764e-01f,-2.685317172923725737e-01f,4.553033317622558196e-03f,-2.024846109686832263e-01f,-1.524438853300283669e-01f,-8.636192612774153468e-03f,3.160534787308585392e-01f,-1.666025142323384611e-01f,1.160917075404059168e-01f,-3.506055349819585665e-01f,
2.832151175390338303e-03f,2.109363190338324201e-01f,-2.041634876000660570e-01f,-2.469416911561398142e-01f,-1.142433433162561573e-01f,-5.774051590567363251e-02f,-1.293225498788374284e-01f,-1.072477877326733497e-01f,7.754313210599494098e-03f,3.117172132831834697e-01f,2.826108633362933373e-02f,5.528631246952084299e-02f,-3.120953741122223790e-01f,2.872629699356988309e-01f,2.623780035543076261e-01f,1.014511196745735561e-01f,2.233305834882774454e-01f,-1.589228947990894980e-01f,-2.957219252594951373e-02f,1.856755642088646699e-02f,1.462447276355474113e-01f,-1.251367792745910687e-02f,2.591937184686520235e-01f,1.945539443510858058e-01f,2.322944554314272936e-01f,2.734199043983665534e-01f,2.010642759933168322e-01f,1.015862114096824226e-01f,1.653814114536622248e-01f,1.419830872821519208e-01f,1.006716265319627657e-01f,-8.967786825331608425e-02f,
-2.086167470225251952e-01f,-1.948586010421530512e-01f,-7.103442651501969130e-02f,3.685817986214841302e-02f,2.058127244188150684e-01f,-2.320205838094106798e-01f,-2.650762879496429414e-01f,6.065411905250998187e-02f,5.007459675003602534e-02f,-1.848986531846674441e-01f,-2.686237210349700644e-01f,1.827597459915982492e-01f,2.473649745363003805e-01f,1.596140493398672255e-01f,-1.304587706004537717e-01f,-2.588669734764804664e-01f,-9.141242658053104486e-02f,1.638901657044512794e-01f,4.842284848107379636e-02f,-7.366069794861021015e-03f,1.181264205946242207e-01f,-2.464835907910462309e-01f,-2.158263508489107474e-01f,-5.526757441353846723e-02f,2.316925226867201301e-02f,-2.657423543421096879e-01f,9.603752512251068074e-02f,-2.701548252838141817e-01f,-1.117894340239325712e-01f,-4.881036520106783044e-02f,-2.428699928127133756e-01f,1.995717937756657234e-01f,
2.485478992524805253e-01f,-2.771385227889172076e-01f,1.050659243959966432e-01f,1.390715872349920501e-01f,-2.491178038464968436e-01f,-1.427204153380101648e-01f,-2.625762797051570674e-01f,4.550385697886528275e-02f,-2.593879220791729390e-01f,1.561321945296809954e-01f,-2.427231712702768163e-02f,8.599814551149372044e-02f,8.168784459006116216e-02f,4.456944012495328566e-02f,1.701220043612516192e-02f,-2.689508337945889505e-01f,-2.936190080068263875e-01f,-2.544093856516459473e-01f,3.099533547289841096e-01f,1.602919632144951534e-01f,1.379827920048252166e-01f,6.370798044308878180e-03f,1.516017780368736911e-01f,9.215641327135919159e-02f,-1.630316206803295309e-01f,-1.465473033339660391e-01f,1.535016270538419603e-01f,-2.023827083660768023e-01f,1.992273840414732211e-01f,-9.429515488034453941e-02f,-4.596252141185350887e-02f,-1.006778595839679935e-01f,
-2.858889539411019753e-01f,-9.842876961018395821e-02f,-1.310578078911492361e-01f,-2.298671255583272510e-01f,1.521967468779831800e-01f,2.247818820007991547e-01f,-1.673601800384162952e-01f,-1.045394893022686261e-01f,-2.272573619542161139e-01f,-7.946355110795091936e-02f,1.053659054190438094e-01f,1.203923861067078965e-01f,-1.424629902947081861e-01f,-7.480833344713519462e-02f,-3.131600671457352575e-02f,-2.833767483682619881e-01f,-1.900304654103089075e-01f,1.390241518409998100e-01f,-1.498123782754376687e-01f,-2.640472859932663230e-01f,-8.151846147537665163e-03f,-3.151501971166644767e-01f,1.838075482431260066e-01f,2.927805871933213955e-01f,-3.852879030446226816e-02f,2.453664972828223378e-01f,1.257636726069439326e-01f,1.200845955389137631e-01f,-1.519673859696560325e-01f,-1.751780795287448123e-01f,-8.941000803024608257e-02f,-1.225007804182314392e-01f,
5.950979094803922342e-02f,1.803970058937809928e-01f,-3.047257584337894620e-01f,8.941833113927200732e-03f,-1.994502201524557261e-01f,-8.611872873765354097e-02f,1.612498157074064575e-01f,-2.022894838759451974e-01f,-1.116967495973027746e-01f,2.974159605057821038e-02f,-2.163142718385772933e-01f,-3.240579321411777847e-01f,1.728442524147289217e-01f,2.631946234499111803e-01f,-3.090741319384442409e-01f,-1.548044643293753353e-01f,-2.116351659801877227e-01f,-5.126660046639586188e-02f,3.096575034515388625e-01f,-1.193075258450766590e-01f,1.734728727364484580e-01f,2.053523369211212590e-01f,-1.262762501573265125e-02f,-1.368191444562875669e-01f,-2.879079704169136278e-01f,-5.386550471863414680e-02f,-2.936842045702010157e-02f,8.741530471771304101e-02f,1.220094406960608828e-02f,7.738414486373614010e-02f,-6.294836087932695334e-02f,-1.413409401818074007e-01f,
-2.384534660369390935e-01f,-1.204125160741691403e-01f,-8.599485617034380303e-02f,-5.234271793816589607e-02f,-1.759080965159031673e-01f,1.221783059071170352e-01f,-3.053233387918115674e-02f,2.418856868595964937e-01f,2.733790509370683242e-01f,1.950881884072321049e-02f,-2.961746137664660328e-01f,1.871219335564830166e-01f,-2.784522403342015728e-01f,1.345092189035389518e-01f,1.224157076219953844e-01f,1.172035183285853877e-01f,-2.810772534457087191e-01f,-1.180249024170358235e-01f,1.133767924737043159e-01f,3.097559074138730439e-01f,-2.050312948334681237e-02f,1.192335776820129534e-01f,1.049291436164445090e-01f,2.420071823845098558e-01f,1.357757696752354137e-01f,-2.592607565540357983e-01f,1.079642328902963161e-01f,-1.196854123708089752e-02f,6.866581223083613461e-02f,-2.414890404296443638e-01f,1.926021545242012634e-01f,-8.638410225380044327e-02f,
2.836978625697376688e-01f,2.124119032237843652e-02f,1.374445605796472680e-01f,-5.992151054424600665e-02f,2.102881451172654848e-01f,-6.903755318204522762e-02f,-2.615534805165106169e-01f,-2.972272214398140600e-01f,-2.768434567483499253e-01f,-1.235279927879048660e-02f,-1.551769422047434288e-01f,-2.251817437278687550e-01f,-1.729693297455157652e-01f,-6.198812148378648502e-03f,2.642230193361774226e-01f,-2.485479818389075835e-01f,-2.000180129677542051e-01f,-4.866550793541909309e-02f,5.261024802950058782e-02f,1.129117927370088537e-01f,-1.545255072399744911e-01f,-1.349873940296655687e-02f,-1.331462621068093544e-01f,2.366783592877544085e-01f,-4.933805076245811189e-02f,1.763472252495931203e-01f,-1.279202069995185598e-01f,-9.289116844443189025e-02f,2.126707817276413115e-01f,-2.841237902676396754e-01f,-1.748757869475669191e-01f,8.338982212764181612e-02f,
1.690506230200692350e-01f,-1.158502583832482849e-02f,-6.529775692052311453e-02f,-6.135771588574039093e-02f,1.414074854017638716e-01f,1.349403186096885809e-01f,-1.746162383104367388e-01f,2.540789016811323409e-01f,2.963358931456450129e-01f,2.707615136352242713e-01f,5.036052760518589660e-02f,1.208504973211525918e-01f,5.718165773862364520e-02f,-1.611678439663873520e-03f,2.737721745175869525e-01f,3.005574791104310139e-01f,-7.651669273285202633e-02f,5.540146887539921378e-02f,3.026119981894216382e-01f,-6.135743601145202814e-02f,-2.418420979089601353e-01f,-7.730239236918355628e-02f,4.230415897164582079e-02f,-1.267562666239715197e-01f,-6.207319381271667741e-02f,3.019587251205654854e-01f,7.625414076446440648e-02f,2.620102549224290756e-01f,2.093585234361306502e-01f,-2.778277487000476720e-01f,-5.541368681994178480e-02f,5.488181243905140144e-02f,
-2.164431796929465746e-01f,2.325899065951666789e-01f,2.678719262433872927e-01f,-2.392453696098972571e-01f,-2.808687974126817810e-01f,1.791422379049580627e-01f,1.186833213837480416e-01f,4.137434721984549479e-02f,-4.133622098636467040e-02f,-3.061591531581482895e-01f,-1.378628356483400930e-01f,1.920880933442929983e-01f,4.057648113956597441e-02f,-2.535334431953544798e-01f,1.031560559680191891e-01f,-1.385184750923744434e-01f,1.739698012835842189e-01f,-5.922014962562641149e-02f,-2.670752136869860571e-01f,5.880616480519467587e-02f,1.406661255290306833e-01f,-2.945925334402556273e-02f,-2.443731879805308982e-01f,-6.081449490396766133e-02f,2.080892109481269348e-01f,-1.631165262986329911e-01f,4.153646108674484763e-03f,2.570594827363977264e-01f,-2.773349675271646886e-02f,-1.103830003396070319e-01f,1.587640478421560586e-01f,-1.714282063527301780e-01f,
-1.844973205710973840e-01f,-2.122191319827846923e-01f,-2.207901205558878976e-01f,1.699057447273676913e-01f,-2.130845980179425225e-01f,-4.573122662140655104e-02f,5.390641921995791702e-02f,-1.387852804551705822e-02f,2.245551098982290217e-01f,-1.840639852117618158e-01f,1.611296314670869478e-01f,-1.211151057007585352e-01f,-1.365554749422632497e-01f,2.606348984070113728e-01f,1.674935672258234809e-01f,-3.121137216701650452e-01f,3.930576467058560786e-02f,-1.399439074844030240e-01f,7.117684640041280209e-02f,2.633457878742517799e-01f,1.394499050330953727e-01f,-4.254599640433763715e-03f,-2.198675327032020843e-02f,-2.961692633211505665e-01f,-5.268569375993266413e-02f,2.923942969206012599e-01f,-2.579822624599293346e-01f,2.464492680571347683e-01f,2.261297776000438173e-02f,-7.295913437104101229e-02f,1.762862673234866784e-01f,6.745169695652288890e-03f,
-5.202036711130751667e-02f,-1.482862780955012671e-01f,1.399137166160728807e-01f,-1.023344129524194901e-01f,2.290171927289191833e-02f,-3.108746440951768442e-01f,-1.140424463001914052e-01f,7.591520769059512119e-02f,3.048087280867870508e-01f,-2.784729443374345248e-01f,3.054037781475661961e-01f,2.981615386705990453e-02f,2.702174608956094404e-01f,2.900718099926273830e-01f,2.775784732357826079e-01f,-7.455373408924438616e-02f,8.068293831305640984e-02f,1.950951201630918286e-01f,-2.137445625802849025e-01f,-5.249082775954958674e-02f,-7.975595281859047814e-02f,1.403442118828041596e-01f,1.716119226732147340e-01f,-9.509198201883044266e-02f,-6.849089770843251254e-03f,1.632599289615208893e-01f,-2.530764733749251150e-01f,-4.924476691287590219e-02f,1.206856765074182519e-01f,-2.648016848111067051e-02f,2.427544120987490117e-01f,-1.850547087647552973e-03f,
-1.891535129800008264e-01f,2.683824443738660470e-01f,1.461958912291985158e-01f,-1.937096467903447194e-02f,-2.248755910965568872e-01f,-1.602179869848090465e-01f,1.938458702836811098e-01f,8.409622421467739806e-02f,1.010152008145219771e-01f,5.619975974720190642e-02f,1.349754814206582387e-01f,-2.586588261375816766e-01f,-1.944932207832816562e-01f,1.731525548161313710e-01f,2.992537584058834743e-01f,1.358679285108544132e-01f,-2.398182521633187292e-01f,2.076641905289027812e-01f,-6.038624162101769582e-02f,3.677283919723429995e-02f,-1.528430241604716577e-01f,-2.396240707346967425e-01f,-1.383368225918358008e-01f,-2.116190203037856543e-01f,2.398174826842011664e-01f,-1.629506395076009972e-01f,9.568515741101117633e-02f,-2.063423195652471231e-01f,1.173253324196736058e-01f,-2.258670105599109579e-01f,-1.469808520429880250e-01f,5.224517798946648472e-02f,
1.661099413549718407e-01f,-3.390849608974809090e-04f,-1.041257275853653408e-01f,-1.319000652124151240e-01f,8.934193631154589699e-02f,-2.981845789854850604e-01f,2.248298465960604231e-01f,-2.279951486157748008e-01f,-3.678230547046052595e-02f,2.343061720382887680e-01f,-1.609606986508307913e-01f,-2.409016101899115816e-02f,9.934561752638210175e-02f,2.688445707038830124e-01f,2.274654254652835050e-01f,-2.341339955368004766e-02f,-2.738182949137544231e-01f,2.674562007137418762e-01f,-2.153654048932128473e-01f,6.460872040103796468e-03f,1.015684442989130392e-03f,1.357743496824835236e-02f,2.808574167902212482e-01f,-2.951176839608559213e-02f,1.814789102356314798e-01f,-1.935435941946725968e-01f,1.534074107122479491e-01f,-1.685064761226073571e-01f,-1.015696481919756977e-01f,-2.768832078690545706e-01f,-2.114211024889381951e-01f,2.631692453628696124e-02f,
-1.123024691174790840e-01f,-2.207765581616376593e-01f,1.566498519780654686e-01f,1.378634071492994273e-02f,2.888701800051007296e-01f,9.222221314263774616e-02f,-4.893815261492675400e-02f,-8.943323881044604184e-02f,-2.509788341818177115e-01f,9.080363559791357342e-02f,7.450898561311102009e-02f,-2.805859372778340410e-01f,1.000379938421779719e-01f,2.629711109634356170e-01f,-2.009924906670265410e-01f,7.495409420976185955e-02f,-1.804908473078970510e-01f,5.906093492403665518e-02f,-1.123511650853072502e-01f,2.999975400279299431e-01f,9.566679054446959596e-02f,-5.449633505450693360e-02f,-2.525330208114557329e-01f,2.712995376277384241e-02f,-2.219639049101559125e-01f,-9.698178757187965113e-03f,2.676320682962513575e-01f,-3.032097801296013695e-01f,-2.061958002216739694e-01f,-2.174746653893999682e-01f,-1.023110132889975682e-01f,4.855127965136037116e-02f,
2.592013395798339337e-01f,1.535020222676762303e-01f,-1.188172744865494540e-01f,5.250002329823571373e-02f,-2.487412674729742035e-01f,2.432898112772204358e-01f,1.910176395092795243e-01f,2.236377146743821764e-01f,-2.217375437993828746e-01f,2.106648067054015250e-01f,-7.467397456254883104e-02f,2.438790990760137944e-01f,-1.448920880560094493e-01f,-2.301644774896058898e-01f,-8.961641864322401896e-02f,2.157949211496341113e-01f,-2.618371127568707157e-01f,2.834389195698384933e-02f,1.333007849071011532e-02f,-1.169663418987837156e-01f,2.202511884229686745e-01f,1.732669985170325611e-01f,2.374392762935503554e-01f,5.115516237877356515e-02f,9.539370536761407338e-02f,1.864779629212923173e-01f,2.366491083935344519e-02f,-7.143705595743969627e-02f,-4.917091613274628126e-02f,-6.454644365101841474e-02f,2.471086837010260662e-01f,2.443660170783556740e-01f,
1.388092828290472536e-01f,2.473667707936812177e-01f,-7.466566482489686574e-02f,-1.863331839252690414e-01f,-1.349971090569340726e-01f,-2.471234626237840126e-01f,2.603288159850097316e-01f,-8.621163197124574740e-02f,-7.446651634770794226e-02f,-9.330763037702196130e-03f,1.566879621851570148e-01f,3.271207033344207538e-02f,-1.589472824532618123e-01f,-2.433608533916837291e-01f,2.165666748423534793e-01f,3.820527486029355602e-02f,1.991156709949546966e-01f,-2.863900867306358733e-01f,-1.996746131598474971e-01f,-2.076088987179503242e-01f,-1.622150645116399725e-01f,-2.507244347634801085e-01f,5.309608116900835229e-02f,-4.189896321304412835e-02f,1.620541434282962712e-01f,2.241878952481793086e-01f,2.481275539573159494e-01f,-1.245072223372905851e-01f,2.005953196737293998e-01f,-2.296056438498610131e-01f,-1.207301099191393223e-01f,3.365773369021217432e-02f,
1.247996151911644758e-01f,2.147331596125116593e-01f,-1.987895200125658901e-01f,1.782362823368125182e-01f,7.145995441535794857e-02f,-2.651461208819119730e-01f,2.034151036175423366e-01f,-1.253541213427031200e-03f,-6.603527366051824277e-02f,3.865614127810432926e-02f,2.720913255919319429e-01f,-2.549906839792972502e-01f,1.666459372767171987e-02f,1.886087507143889841e-01f,-1.318363394540718325e-01f,1.876173779075765713e-01f,-2.221715926932553986e-01f,-1.599483318474055893e-01f,-2.249864964245399390e-01f,2.872117971103771983e-01f,1.346608948316859178e-01f,-2.965405627357678986e-01f,-9.355514497517614450e-03f,7.553792199117115302e-02f,-9.293807995284446288e-02f,-9.342973295368289799e-02f,-2.120583100279918032e-01f,-1.171680988960364100e-01f,1.218353362525711053e-01f,-2.850238907811970535e-01f,1.453225005723136620e-01f,6.098091203829403978e-02f,
7.816391977796373347e-02f,-1.380470130340194224e-01f,2.788367343264185894e-01f,2.167095331698019600e-01f,1.603377968678204035e-01f,6.067170622475648312e-02f,-3.203659258267299026e-01f,-3.126319285071036402e-01f,-7.749246680737771620e-02f,-2.180825318446977801e-01f,-1.141331414045258369e-01f,-2.155742629569791791e-01f,-1.912121941842769290e-01f,5.528489153242833326e-02f,2.102624831783053705e-01f,3.008427055528201666e-01f,1.860085209609698698e-01f,7.031134928900083236e-02f,1.613436891775471005e-01f,2.609690742265602936e-01f,-4.771048729819019757e-02f,-3.746438462115797281e-04f,-2.518210120356531023e-01f,-5.413404414551472449e-02f,1.684682437561555168e-01f,-1.674609120845520494e-01f,-5.610157680989391604e-02f,1.602119450689647173e-01f,6.058815824006677508e-02f,2.352872768315463110e-03f,-1.187547129093480258e-01f,-1.662526248980329413e-01f,
-1.306280347820269749e-01f,-9.008886794035245171e-02f,2.743122087836005751e-01f,2.156973144076177462e-01f,1.425020294632823037e-01f,9.644305982504680630e-02f,6.219104705442195929e-02f,6.477676408612065978e-04f,1.307359263475739442e-01f,7.198457712319059065e-02f,-6.084427211489922688e-02f,-2.121878287731692736e-01f,-2.105794295018153031e-02f,-2.667919966143910138e-01f,2.589385250459844134e-01f,2.863445530904319969e-01f,4.927127787009910609e-02f,-1.875037425786632850e-01f,-1.232503069775032628e-01f,9.558601352664694226e-03f,-2.390646370498313855e-01f,1.064265703525547196e-01f,2.405968490056691333e-01f,-2.074071318717704837e-01f,-2.711754768691452266e-01f,2.161741828805299470e-01f,-2.303168703811717677e-01f,3.414186638418999914e-02f,-3.043585304691117099e-01f,6.538804768594888572e-02f,-1.646332332477266069e-01f,-8.464792387863616374e-02f,
1.659736773443751603e-02f,-3.879628021608481220e-02f,2.615817129252551165e-01f,1.153277667261960321e-01f,7.591861011613497412e-02f,-1.178982201503118721e-01f,1.536649105262958004e-01f,-1.072118812915566766e-01f,-1.612211144740826607e-01f,1.423812587944832675e-01f,-1.651257163930430760e-02f,2.924924838695726684e-02f,6.021185479094369464e-02f,2.187011645291166428e-01f,4.610730302828311422e-02f,2.968375948092598082e-01f,-1.700319769631263023e-01f,-1.626804487606796634e-01f,3.020276973668743481e-01f,9.857973186399408838e-02f,2.439332591744626244e-01f,3.028946567431102799e-01f,2.693168785612702898e-01f,-6.737618819434752770e-02f,-2.692102929403447642e-01f,-1.929681106893469666e-01f,1.868435744370857965e-01f,-1.676105071537163649e-01f,2.100490002608641771e-01f,-2.172688212344101033e-01f,-1.438185692915493474e-01f,-5.724503261723067754e-02f,
5.512378006742912201e-02f,1.767174961955401413e-01f,-1.300746636794913036e-01f,1.418431917555926236e-01f,2.577214952587970620e-01f,-8.290900995504744964e-02f,1.293580017685090622e-01f,-2.797976847431469724e-02f,-2.931330444780874678e-02f,-1.836731583116381628e-01f,-1.091033871301779791e-02f,-2.939882119158817586e-01f,1.128386245766216101e-01f,1.808007516039955020e-01f,3.896063089531608126e-02f,-6.193366399390149921e-03f,-1.586843022169278639e-01f,-1.198901872870987012e-01f,-2.010623030068100503e-01f,2.762306520003262045e-01f,-1.918962566864949593e-01f,2.502804264535247181e-01f,1.054274384961272626e-01f,-3.173405274632415951e-01f,2.885094101558768540e-02f,-2.564214816959018983e-01f,2.157475607064716916e-01f,-4.175850299990140763e-02f,-1.459426072770595162e-01f,-2.476399257185716851e-01f,-3.146246271680365192e-01f,-7.553156611723173264e-02f,
-1.723003900596110916e-01f,-2.053853457163230256e-01f,2.533119624426834540e-02f,2.651067213798879441e-01f,-1.558969941056635201e-02f,-4.649207955954312577e-02f,3.824227207709211818e-02f,-2.816459172813826073e-01f,1.973125206893689976e-01f,2.460538000214741172e-01f,-2.302088121192054360e-01f,-9.988027803674017976e-03f,-1.397645647016804715e-01f,-2.256838298818263921e-01f,-2.278501258376311733e-01f,2.357221486077853700e-01f,-9.159412240153926021e-02f,-1.032248942946693143e-01f,-2.910607375837428457e-01f,-2.138980847526277540e-01f,-2.828647750451424026e-01f,-8.029363788530964607e-02f,-3.749726141178215399e-02f,-1.414268669940070278e-01f,1.456918503954441335e-01f,-2.105699095273257104e-01f,2.709559609052586415e-01f,-9.867365364329287736e-02f,9.563514889440857814e-02f,1.096582000327906009e-01f,-8.526969904117757959e-02f,9.462632681485010078e-02f,
5.017272293102144343e-02f,1.337233223304259699e-01f,-2.765578777853074377e-01f,-2.802729254151174465e-01f,-1.314520443765460622e-01f,-3.639222885623692727e-02f,-1.886866403731127795e-01f,-1.829165386687786055e-01f,2.164192458288826670e-01f,-2.021932478978705761e-01f,4.765533788102196966e-02f,-1.145965704740430635e-01f,2.866971596773210673e-01f,6.108822018216474026e-02f,-1.836110607447692111e-01f,1.365549926366726140e-02f,1.792843889595798768e-01f,1.027572925037624624e-01f,2.042317149701678713e-01f,1.282802518324149994e-02f,-1.169156525593953583e-01f,2.552305524944000203e-01f,1.528161635019073539e-01f,6.556499789919784105e-02f,-4.699441746129149472e-02f,-1.943349575926728856e-01f,-2.379299954841665732e-01f,-2.130340847789564951e-02f,1.719627549866510341e-01f,3.377734023534046393e-01f,-8.517677891947934843e-02f,-2.737742743818327718e-01f
};

static Real testVi2[72] = {
-3.246074687691009181e-02f,2.024620216693232555e-01f,-1.527198158721925214e-01f,-6.004803054464358247e-01f,-4.144061292852466716e-01f,-1.622722771117650342e-01f,-5.740296049592050753e-01f,-2.155939958042513149e-01f,
2.553111066408023447e-02f,4.685791058023652256e-01f,-4.183198248490498927e-01f,4.175436752893934567e-01f,1.900901432884074260e-01f,-1.709841110926822449e-01f,5.968629984142609368e-01f,9.398042168545479857e-02f,
1.004969943109242508e-01f,4.092602904486949411e-01f,2.567777161632708305e-01f,4.817588491407913676e-01f,-3.999552331107975034e-01f,4.595019300377656823e-01f,1.111340300604473641e-01f,3.753971226770582148e-01f,
-4.812758727170843298e-01f,2.664155251157259152e-01f,-2.280649070114783641e-02f,1.567069961814411549e-01f,-4.373272146073327038e-01f,4.368661544345343040e-01f,-3.768611149770013102e-01f,3.849514958265184417e-01f,
2.100425257049234051e-01f,3.173510442220258687e-01f,4.253451329700114192e-01f,4.187332146314581838e-01f,-2.874784457394252146e-01f,-2.068727293009141044e-01f,4.453089307393089946e-01f,4.185382160095575954e-01f
};

#define VectorCount 4
#define VectorDim 4
#define VectorData testVi2

void TestProbabilityDifferentDimension(CParameters& params)
{
    //CCString sValues;
    //INT iValues;

    //CCString sFileName;
    //__FetchStringWithDefault(_T("CSVFileName"), _T(""));
    //sFileName = sValues;

    //CCString sAmplitudeFileName;
    //__FetchStringWithDefault(_T("AmplitudeSave"), _T(""));
    //sAmplitudeFileName = sValues;

    //CCString sMeasureFileName;
    //__FetchStringWithDefault(_T("MeasureSave"), _T(""));
    //sMeasureFileName = sValues;

    //UINT uiCount = 0;
    //UINT uiRepeat = 0;
    //__FetchIntWithDefault(_T("Count"), 0);
    //uiCount = static_cast<UINT>(iValues);

    //__FetchIntWithDefault(_T("Repeat"), 0);
    //uiRepeat = static_cast<UINT>(iValues);

    //QLQuantumKmeans::TestCircuitBuildState(sFileName, sAmplitudeFileName, sMeasureFileName, uiCount, uiRepeat);

    QLComplex vi[VectorCount * VectorDim];
    QLComplex u[VectorDim];
    for (UINT y = 0; y < VectorCount; ++y)
    {
        for (UINT x = 0; x < VectorDim; ++x)
        {
            UINT idx = y * VectorDim + x;
            vi[idx] = _make_cuComplex(VectorData[2 * idx], VectorData[2 * idx + 1]);
        }
    }
    const UINT idxStart = 2 * VectorCount * VectorDim;
    for (UINT x = 0; x < VectorDim; ++x)
    {
        u[x] = _make_cuComplex(VectorData[idxStart + 2 * x], VectorData[idxStart + 2 * x + 1]);
    }

    QLMatrix vim = QLMatrix::CopyCreate(VectorCount, VectorDim, vi);
    QLMatrix um = QLMatrix::CopyCreate(1, VectorDim, u);

    //vim.Print("vim");
    //um.Print("um");

    QLQuantumKmeans::TestCircuitBuildStateOnce(vim, um, VectorCount, VectorDim);
}

//=============================================================================
// END OF FILE
//=============================================================================